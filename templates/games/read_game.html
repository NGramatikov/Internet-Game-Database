{% extends 'base.html' %}

{% block title %}Read game{% endblock %}

{% block content %}
This is the Read Game page<br><br>

These are the common fields:<br>

Name: {{ game.name }}<br>
Added by: {{ game.user.username }}<br>

{% if game.description %}
Description: {{ game.description }}<br>
{% endif %}

{% if game.genre %}
Genre: {{ game.genre }}<br>
{% endif %}

Age Rating: {{ game.age_range }}+<br>

{% if game.cover %}
Cover: {{ game.cover }}<br>
{% endif %}<br>

These are the fields, specific to the game type:<br>
{% if game.type == "Video Games" %}
    Release Year: {{ game.release_year }}<br>
    
    {% if game.trailer %}
        Trailer: {{ game.trailer }}<br>
    {% endif %}
        
    {% if game.gameplay %}
        Gameplay: {{ game.gameplay }}<br>
    {% endif %}
    
    Developer: {{ game.developer }}<br>
    
    Publisher: {{ game.publisher }}<br>
    
    {% if game.system_requirements %}
        System Requirements: {{ game.system_requirements }}<br>
    {% endif %}

{% else %}
    Players: {{ game.players }}<br>
    
    Rules: {{ game.rules }}<br>
    
    {% if game.setup_time%}
        Setup Time: {{ game.setup_time|time:"H:i" }}<br>
    {% endif %}
    
    {% if game.playtime %}
        Playtime: {{ game.playtime|time:"H:i" }}<br>
    {% endif %}
    
    Chance: {{ game.chance }}<br>
    
    {% if game.skills %}
        Skills: {{ game.skills }}<br>
    {% endif %}
{% endif %}<br>

{% if not user.is_authenticated %}
    <button id="like_button" onclick="window.location.href='{% url 'sign_in' %}';">Like</button>
{% elif user.is_authenticated and not is_liked %}
    <form action="{% url 'create_like' slug=game.slug %}" method="post" class="like-form">
    {% csrf_token %}
    <button type="submit">Like</button>
    </form>
{% elif user.is_authenticated and is_liked %}
    <form action="{% url 'delete_like' slug=game.slug %}" method="post" class="like-form">
    {% csrf_token %}
    <button type="submit">Dislike</button>
    </form>
{% endif %}


{% if not user.is_authenticated %}
    <button id="comment_button" onclick="window.location.href='{% url 'sign_in' %}';">Comment</button>
{% elif user.is_authenticated%}
    <button id="comment_button" onclick="window.location.href='{% url 'create_comment' slug=game.slug %}';">Comment</button>
{% endif %}

{% if not user.is_authenticated %}
    <button id="rate_button" onclick="window.location.href='{% url 'sign_in' %}';">Rate</button>
{% elif user.is_authenticated and not is_rated %}
    <button id="rate_button" onclick="window.location.href='{% url 'create_rating' slug=game.slug %}';">Rate</button>
{% elif user.is_authenticated and is_rated %}
    <button id="rate_button" onclick="window.location.href='{% url 'update_rating' pk=rating.id %}';">Your rating: {{ rating.content }}/10</button>
{% endif %}

{% if not user.is_authenticated %}
    <button id="review_button" onclick="window.location.href='{% url 'sign_in' %}';">Review</button><br>
{% elif user.is_authenticated and not is_reviewed %}
<button id="review_button" onclick="window.location.href='{% url 'create_review' slug=game.slug %}';">Review</button><br>
{% elif user.is_authenticated and is_reviewed %}
    <button id="review_button" onclick="window.location.href='{% url 'update_review' slug=review_slug %}';">Your Review</button>
{% endif %}

<br>
Likes: {{ game.likes.all | length }}<br>
Average Rating: {{ avg_rating }}<br>

Reviews:
<ul>
{% for review in game.reviews.all %}
    <li><a href="{% url 'read_review' slug=review.slug %}">{{ review.title }}</a></li>
{% endfor %}
</ul>

Comments:<br>
<ul>
{% for comment in game.comments.all %}
    <li>
    {{ comment.content }}<br>
    Added by: {{ comment.user.username }}<br>
    Added on: {{ comment.created_at }}<br>
    {% if is_commented %}
    <button id="eddit_comment_button" onclick="window.location.href='{% url 'update_comment' pk=comment.id %}';">Edit Comment</button>
    {% endif %}
    </li>
</ul>
{% endfor %}
    


{% endblock %}
